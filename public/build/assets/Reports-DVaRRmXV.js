import{r as g,G as b,j as e,S as j}from"./app-BWyxNqfQ.js";import{S as f,C as h}from"./SuperAdminLayout-BWxKC8Em.js";import{B as N}from"./building-2-DYYZHcxg.js";import{U as v}from"./users-DSc3F087.js";import{C as w}from"./chart-column-BXot9zuD.js";import{F as y}from"./file-text-if0-f0e7.js";import{D as k}from"./download-63HtZvrZ.js";import"./x-DCgTbUtL.js";import"./createLucideIcon-k7Y_xLnS.js";function _({errors:L,flash:t}){var c;const[r,p]=g.useState(""),[a,o]=g.useState({start:"",end:""}),{processing:i}=b(),m=[{id:"schools",title:"Laporan Sekolah",description:"Data lengkap semua sekolah terdaftar",icon:N,color:"bg-maroon-500"},{id:"students",title:"Laporan Siswa",description:"Data lengkap semua siswa dan performanya",icon:v,color:"bg-green-500"},{id:"results",title:"Laporan Hasil",description:"Data hasil ujian dan skor siswa",icon:w,color:"bg-purple-500"},{id:"questions",title:"Laporan Bank Soal",description:"Data lengkap bank soal dan kunci jawaban",icon:y,color:"bg-orange-500"}],u=()=>{var x;if(!r)return;console.log("Data yang akan dikirim:",{type:r,start_date:a.start,end_date:a.end});const s=new FormData;s.append("type",r),a.start&&s.append("start_date",a.start),a.end&&s.append("end_date",a.end),fetch("/reports/download",{method:"POST",headers:{"X-CSRF-TOKEN":(x=document.querySelector('meta[name="csrf-token"]'))==null?void 0:x.getAttribute("content"),Accept:"text/csv"},body:s}).then(n=>n.ok?n.blob():n.json().then(d=>{throw new Error(d.error||"Download gagal")})).then(n=>{const d=window.URL.createObjectURL(n),l=document.createElement("a");l.href=d,l.download=`laporan_${r}_${new Date().toISOString().slice(0,10)}.csv`,document.body.appendChild(l),l.click(),window.URL.revokeObjectURL(d),document.body.removeChild(l),console.log("Download berhasil!")}).catch(n=>{console.error("Error:",n),alert("Gagal mengunduh laporan: "+n.message)})};return e.jsxs(f,{children:[e.jsx(j,{title:"Laporan"}),e.jsxs("div",{className:"p-4 sm:p-6",children:[e.jsx("div",{className:"bg-white shadow-sm border rounded-lg mb-4 sm:mb-6",children:e.jsx("div",{className:"px-4 sm:px-6 py-4",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900",children:"Laporan"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Download laporan data sistem"})]})})}),(t==null?void 0:t.success)&&e.jsx("div",{className:"mb-4 sm:mb-6 bg-green-50 border border-green-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("svg",{className:"h-5 w-5 text-green-400",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})})}),e.jsx("div",{className:"ml-3",children:e.jsx("p",{className:"text-sm font-medium text-green-800",children:t.success})})]})}),(t==null?void 0:t.error)&&e.jsx("div",{className:"mb-4 sm:mb-6 bg-red-50 border border-red-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("svg",{className:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),e.jsx("div",{className:"ml-3",children:e.jsx("p",{className:"text-sm font-medium text-red-800",children:t.error})})]})}),e.jsxs("div",{className:"mb-6 sm:mb-8",children:[e.jsx("h2",{className:"text-base sm:text-lg font-semibold text-gray-900 mb-4",children:"Pilih Jenis Laporan"}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 sm:gap-6",children:m.map(s=>e.jsx("div",{onClick:()=>p(s.id),className:`bg-white rounded-lg shadow-sm border p-4 sm:p-6 cursor-pointer transition-all duration-200 hover:shadow-md ${r===s.id?"ring-2 ring-maroon-500 border-maroon-500":"hover:border-gray-300"}`,children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:`p-2 sm:p-3 rounded-lg ${s.color}`,children:e.jsx(s.icon,{className:"h-5 w-5 sm:h-6 sm:w-6 text-white"})}),e.jsxs("div",{className:"ml-3 sm:ml-4",children:[e.jsx("h3",{className:"text-sm sm:text-base font-semibold text-gray-900",children:s.title}),e.jsx("p",{className:"text-xs sm:text-sm text-gray-500",children:s.description})]})]})},s.id))})]}),r&&e.jsxs("div",{className:"mb-6 sm:mb-8",children:[e.jsx("h3",{className:"text-base sm:text-lg font-semibold text-gray-900 mb-4",children:"Rentang Waktu (Opsional)"}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border p-4 sm:p-6",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 sm:gap-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx(h,{className:"inline h-4 w-4 mr-2"}),"Tanggal Mulai"]}),e.jsx("input",{type:"date",value:a.start,onChange:s=>o({...a,start:s.target.value}),className:"block w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-1 focus:ring-maroon-500 focus:border-maroon-500"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx(h,{className:"inline h-4 w-4 mr-2"}),"Tanggal Akhir"]}),e.jsx("input",{type:"date",value:a.end,onChange:s=>o({...a,end:s.target.value}),className:"block w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-1 focus:ring-maroon-500 focus:border-maroon-500"})]})]}),e.jsxs("div",{className:"mt-4 flex flex-col sm:flex-row sm:items-center sm:justify-between space-y-2 sm:space-y-0",children:[e.jsx("button",{onClick:()=>o({start:"",end:""}),className:"text-sm text-gray-500 hover:text-gray-700 underline",children:"Reset rentang waktu"}),a.start&&a.end&&e.jsxs("div",{className:"text-sm text-gray-600",children:[e.jsx("span",{className:"font-medium",children:"Rentang:"})," ",a.start," s/d ",a.end]})]})]})]}),r&&e.jsx("div",{className:"bg-white rounded-lg shadow-sm border p-4 sm:p-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between space-y-4 sm:space-y-0",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("h3",{className:"text-base sm:text-lg font-semibold text-gray-900",children:["Download Laporan"," ",(c=m.find(s=>s.id===r))==null?void 0:c.title]}),e.jsx("p",{className:"text-xs sm:text-sm text-gray-500 mt-1",children:"Laporan akan diunduh dalam format CSV (.csv) dengan delimiter semicolon (;) yang siap dibuka di Excel"})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-3",children:[e.jsxs("button",{onClick:u,disabled:i,className:"w-full sm:w-auto inline-flex items-center justify-center px-4 sm:px-6 py-2 sm:py-3 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-maroon-600 hover:bg-maroon-700 disabled:opacity-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-maroon-500",children:[e.jsx(k,{className:"h-4 w-4 mr-2"}),i?"Mengunduh...":"Download Laporan"]}),i&&e.jsx("div",{className:"text-xs sm:text-sm text-gray-500 text-center sm:text-left",children:"⏳ Sedang memproses laporan..."})]})]})}),e.jsxs("div",{className:"mt-6 sm:mt-8",children:[e.jsx("h3",{className:"text-base sm:text-lg font-semibold text-gray-900 mb-4",children:"Informasi Laporan"}),e.jsx("div",{className:"bg-white rounded-lg shadow-sm border p-4 sm:p-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 sm:gap-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Format Laporan"}),e.jsxs("ul",{className:"text-xs sm:text-sm text-gray-600 space-y-1",children:[e.jsx("li",{children:"• File CSV (.csv) dengan delimiter semicolon (;)"}),e.jsx("li",{children:"• Kolom terpisah dengan sempurna di Excel"}),e.jsx("li",{children:"• Siap dibuka di Excel dan Google Sheets"}),e.jsx("li",{children:"• Format yang kompatibel dengan Excel Indonesia"})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Konten Laporan"}),e.jsxs("ul",{className:"text-xs sm:text-sm text-gray-600 space-y-1",children:[e.jsx("li",{children:"• Data lengkap sesuai jenis laporan"}),e.jsx("li",{children:"• Format kolom yang terstruktur"}),e.jsx("li",{children:"• Filter berdasarkan rentang waktu"}),e.jsx("li",{children:"• Nomor urut dan status yang jelas"})]})]})]})})]})]})]})}export{_ as default};
