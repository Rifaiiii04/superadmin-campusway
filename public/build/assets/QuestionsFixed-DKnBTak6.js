import{r as d,G as T,j as e,S as F,A as I}from"./app-BWyxNqfQ.js";import{S as $}from"./SuperAdminLayout-BWxKC8Em.js";import J from"./QuestionTable-DyhHk-ff.js";import K from"./AddQuestionModal-BinyT6Ie.js";import V from"./DeleteConfirmationModal-CEtb6Xz5.js";import W from"./ImportQuestionsModal-BvY_EZl0.js";import{U as H}from"./upload-C5x1fD0L.js";import{P as X,S as Y}from"./search-BZkg0Hpl.js";import"./building-2-DYYZHcxg.js";import"./createLucideIcon-k7Y_xLnS.js";import"./x-DCgTbUtL.js";import"./file-text-if0-f0e7.js";import"./circle-check-big-iQlXotq_.js";import"./square-pen-C3q3_O0u.js";import"./trash-2-DAJOn_S-.js";import"./download-63HtZvrZ.js";function pe({questions:k,errors:_,flash:n}){var w,v;const[S,m]=d.useState(!1),[C,u]=d.useState(!1),[M,b]=d.useState(!1),[g,x]=d.useState(null),[f,A]=d.useState(""),[P,j]=d.useState(!1),[l,y]=d.useState(null),{data:o,setData:i,post:D,put:E,processing:p,reset:G}=T({subject:"",type:"Pilihan Ganda",content:"",media_url:"",options:[{option_text:"",is_correct:!1,label:"A"},{option_text:"",is_correct:!1,label:"B"},{option_text:"",is_correct:!1,label:"C"},{option_text:"",is_correct:!1,label:"D"}]}),c=()=>{G(),i("options",[{option_text:"",is_correct:!1,label:"A"},{option_text:"",is_correct:!1,label:"B"},{option_text:"",is_correct:!1,label:"C"},{option_text:"",is_correct:!1,label:"D"}])},B=()=>{if(o.type==="Pilihan Ganda"&&!o.options.some(t=>t.is_correct)){alert("Pilih minimal satu jawaban yang benar untuk soal pilihan ganda!");return}D("/questions",{onSuccess:()=>{m(!1),c()}})},Q=()=>{if(o.type==="Pilihan Ganda"&&!o.options.some(t=>t.is_correct)){alert("Pilih minimal satu jawaban yang benar untuk soal pilihan ganda!");return}E(`/questions/${g.id}`,{onSuccess:()=>{u(!1),x(null),c()}})},U=a=>{y(a),j(!0)},L=a=>{if(!a){alert("ID soal tidak valid!");return}I.delete(`/questions/${a}`,{onSuccess:()=>{console.log("Soal berhasil dihapus")},onError:t=>{console.error("Delete failed:",t),alert("Gagal menghapus soal. Silakan coba lagi.")}})},O=a=>{var t;x(a),i({subject:a.subject,type:"Pilihan Ganda",content:a.content,media_url:a.media_url||"",options:((t=a.question_options)==null?void 0:t.length)>0?a.question_options.map((r,s)=>({...r,label:["A","B","C","D"][s]||String.fromCharCode(65+s)})):[{option_text:"",is_correct:!1,label:"A"},{option_text:"",is_correct:!1,label:"B"},{option_text:"",is_correct:!1,label:"C"},{option_text:"",is_correct:!1,label:"D"}]}),u(!0)},h=(a,t,r)=>{const s=[...o.options];s[a][t]=r,i("options",s)},R=async a=>{var r;if(a.size>5*1024*1024){alert("Ukuran file terlalu besar! Maksimal 5MB");return}if(!["image/jpeg","image/png","image/gif","image/webp","audio/mpeg","audio/wav","audio/ogg"].includes(a.type)){alert("Tipe file tidak didukung! Gunakan JPG, PNG, MP3, WAV");return}try{const s=new FormData;s.append("media",a),s.append("_token",(r=document.querySelector('meta[name="csrf-token"]'))==null?void 0:r.getAttribute("content"));const N=await fetch("/upload-media",{method:"POST",body:s});if(N.ok){const z=await N.json();i("media_url",z.url),alert("File berhasil diupload!")}else throw new Error("Upload gagal")}catch(s){console.error("Upload error:",s),alert("Gagal upload file. Silakan coba lagi atau gunakan URL manual.")}};return e.jsxs($,{children:[e.jsx(F,{title:"Kelola Bank Soal"}),e.jsxs("div",{className:"p-6",children:[e.jsx("div",{className:"bg-white shadow-sm border rounded-lg mb-6",children:e.jsx("div",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Kelola Bank Soal"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Daftar dan kelola semua soal dalam sistem"})]}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsxs("button",{onClick:()=>b(!0),className:"inline-flex items-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",children:[e.jsx(H,{className:"h-4 w-4 mr-2"}),"Import CSV"]}),e.jsxs("button",{onClick:()=>m(!0),className:"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-maroon-600 hover:bg-maroon-700",children:[e.jsx(X,{className:"h-4 w-4 mr-2"}),"Tambah Soal"]})]})]})})}),(n==null?void 0:n.success)&&e.jsx("div",{className:"mb-6 bg-green-50 border border-green-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("svg",{className:"h-5 w-5 text-green-400",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})})}),e.jsx("div",{className:"ml-3",children:e.jsx("p",{className:"text-sm font-medium text-green-800",children:n.success})})]})}),(n==null?void 0:n.error)&&e.jsx("div",{className:"mb-6 bg-red-50 border border-red-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("svg",{className:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),e.jsx("div",{className:"ml-3",children:e.jsx("p",{className:"text-sm font-medium text-red-800",children:n.error})})]})}),e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"relative max-w-md",children:[e.jsx(Y,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Cari soal...",value:f,onChange:a=>A(a.target.value),className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md focus:ring-1 focus:ring-maroon-500 focus:border-maroon-500"})]})}),e.jsx(J,{questions:k.data,onEdit:O,onDelete:U,searchTerm:f}),e.jsx(K,{isOpen:S,onClose:()=>{m(!1),c()},data:o,setData:i,errors:_,processing:p,onSubmit:B,handleFileUpload:R,handleOptionChange:h,resetForm:c}),C&&g&&e.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",children:e.jsxs("div",{className:"relative top-10 mx-auto p-5 border w-full max-w-2xl shadow-lg rounded-md bg-white",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Edit Soal"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Mata Pelajaran"}),e.jsx("input",{type:"text",value:o.subject,onChange:a=>i("subject",a.target.value),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-1 focus:ring-maroon-500 focus:border-maroon-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Tipe Soal"}),e.jsx("input",{type:"text",value:"Pilihan Ganda",disabled:!0,className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 bg-gray-100 text-gray-500"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Soal"}),e.jsx("textarea",{value:o.content,onChange:a=>i("content",a.target.value),rows:4,className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-1 focus:ring-maroon-500 focus:border-maroon-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Media URL (Opsional)"}),e.jsx("input",{type:"text",value:o.media_url,onChange:a=>i("media_url",a.target.value),placeholder:"https://example.com/image.jpg",className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-1 focus:ring-maroon-500 focus:border-maroon-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Opsi Jawaban (Pilih minimal satu yang benar)"}),e.jsx("div",{className:"space-y-3",children:o.options.map((a,t)=>e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:a.is_correct,onChange:r=>h(t,"is_correct",r.target.checked),className:"h-4 w-4 text-maroon-600 focus:ring-maroon-500 border-gray-300 rounded"}),e.jsxs("span",{className:"ml-2 text-sm font-medium text-gray-700 w-6",children:[a.label,":"]})]}),e.jsx("input",{type:"text",value:a.option_text,onChange:r=>h(t,"option_text",r.target.value),placeholder:`Masukkan opsi ${a.label}`,className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-1 focus:ring-maroon-500 focus:border-maroon-500"})]},t))}),e.jsx("p",{className:"mt-2 text-xs text-gray-500",children:"Centang kotak untuk menandai jawaban yang benar"})]})]}),e.jsxs("div",{className:"flex justify-end space-x-3 mt-6",children:[e.jsx("button",{onClick:()=>{u(!1),x(null),c()},className:"px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50",children:"Batal"}),e.jsx("button",{onClick:Q,disabled:p,className:"px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-maroon-600 hover:bg-maroon-700 disabled:opacity-50",children:p?"Menyimpan...":"Update"})]})]})}),e.jsx(V,{isOpen:P,onClose:()=>{j(!1),y(null)},onConfirm:L,questionTitle:`soal "${(w=l==null?void 0:l.content)==null?void 0:w.substring(0,50)}${((v=l==null?void 0:l.content)==null?void 0:v.length)>50?"...":""}"`,questionId:l==null?void 0:l.id}),e.jsx(W,{isOpen:M,onClose:()=>b(!1),onSuccess:()=>{window.location.reload()}})]})]})}export{pe as default};
