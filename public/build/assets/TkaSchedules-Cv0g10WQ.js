import{r as i,j as e,S as U}from"./app-Cmg1-cqd.js";import{S as W,C as b}from"./SuperAdminLayout-DtwxpEpE.js";import{P as k}from"./PrimaryButton-DPtfE2Ka.js";import{S as w,D as G,M as V}from"./SecondaryButton-BKw7z65O.js";import{T as d}from"./TextInput-CL8WNSQs.js";import{I as r}from"./InputLabel-9X83q88l.js";import{P,S as E}from"./search-DgbF5B6X.js";import{C as N}from"./clock-DqRpNOsT.js";import{c as z}from"./createLucideIcon-CKh2Sp53.js";import{S as Q}from"./square-pen-BfhC4RrU.js";import{T as Y}from"./trash-2-BugzDCVZ.js";/* empty css            */import"./building-2-DIcUuqNa.js";import"./x-B-12kS2G.js";import"./file-text-Cocr6uo_.js";import"./transition-Ew5Inmtz.js";/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],ee=z("funnel",Z);function we({auth:ae,schedules:S=[],schools:D=[],error:_=null}){const[o,se]=i.useState(S),[T,q]=i.useState(S),[C,F]=i.useState(!1),[u,A]=i.useState(""),[x,M]=i.useState("all"),[g,R]=i.useState("all"),[J,h]=i.useState(!1),[B,p]=i.useState(!1),[c,j]=i.useState(null),[s,l]=i.useState({title:"",description:"",start_date:"",end_date:"",type:"regular",instructions:"",target_schools:[],gelombang:"1",hari_pelaksanaan:"Hari Pertama",exam_venue:"",exam_room:"",contact_person:"",contact_phone:"",requirements:"",materials_needed:""});i.useEffect(()=>{let a=[...o];u&&(a=a.filter(t=>{var n;return t.title.toLowerCase().includes(u.toLowerCase())||((n=t.description)==null?void 0:n.toLowerCase().includes(u.toLowerCase()))})),x!=="all"&&(a=a.filter(t=>t.status===x)),g!=="all"&&(a=a.filter(t=>t.type===g)),q(a)},[o,u,x,g]);const L=async a=>{a.preventDefault(),F(!0);try{const t=c?`/tka-schedules/${c.id}`:"/tka-schedules",n=c?"PUT":"POST",f={title:s.title,description:s.description||null,start_date:s.start_date||null,end_date:s.end_date||null,type:s.type,instructions:s.instructions||null,target_schools:s.target_schools||null};console.log("Submitting data:",f);const m=await(await fetch(t,{method:n,headers:{Accept:"application/json","Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').content,"X-Requested-With":"XMLHttpRequest"},body:JSON.stringify(f)})).json();console.log("Response data:",m),m.success?(h(!1),p(!1),j(null),y(),await v()):(console.error("Error saving schedule:",m.message),m.errors&&(console.error("Validation errors:",m.errors),alert("Validasi gagal: "+JSON.stringify(m.errors))))}catch(t){console.error("Error saving schedule:",t)}finally{F(!1)}},v=async()=>{try{window.location.reload()}catch(a){console.error("Error fetching schedules:",a)}},H=a=>{j(a),l({title:a.title,description:a.description||"",start_date:a.start_date,end_date:a.end_date,type:a.type,instructions:a.instructions||"",target_schools:a.target_schools||[]}),p(!0)},I=async a=>{try{const t=await fetch(`/tka-schedules/${a}`,{method:"DELETE",headers:{Accept:"application/json","Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').content,"X-Requested-With":"XMLHttpRequest"}});if(!t.ok){const f=await t.text();throw console.error("Delete error response:",f),new Error(`HTTP error! status: ${t.status}`)}const n=await t.json();n.success?await v():console.error("Error deleting schedule:",n.message)}catch(t){console.error("Error deleting schedule:",t)}},X=async a=>{try{const t=await fetch(`/tka-schedules/${a}/cancel`,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').content,"X-Requested-With":"XMLHttpRequest"}});if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);const n=await t.json();n.success?await v():console.error("Error cancelling schedule:",n.message)}catch(t){console.error("Error cancelling schedule:",t)}},y=()=>{l({title:"",description:"",start_date:"",end_date:"",type:"regular",instructions:"",target_schools:[]})},O=a=>{const t={scheduled:{variant:"default",text:"Terjadwal"},ongoing:{variant:"secondary",text:"Berlangsung"},completed:{variant:"outline",text:"Selesai"},cancelled:{variant:"destructive",text:"Dibatalkan"}};return t[a]||t.scheduled},$=a=>{const t={regular:{variant:"default",text:"Reguler"},makeup:{variant:"secondary",text:"Susulan"},special:{variant:"outline",text:"Khusus"}};return t[a]||t.regular},K=a=>new Date(a).toLocaleDateString("id-ID",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"});return e.jsxs(W,{children:[e.jsx(U,{title:"Jadwal TKA"}),e.jsx("div",{className:"py-12",children:e.jsxs("div",{className:"max-w-7xl mx-auto sm:px-6 lg:px-8",children:[_&&e.jsxs("div",{className:"mb-6 p-4 bg-red-100 border border-red-400 text-red-700 rounded-lg",children:[e.jsx("h3",{className:"font-bold text-lg",children:"Error:"}),e.jsx("p",{children:_})]}),e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"font-semibold text-xl text-gray-800 leading-tight",children:"Manajemen Jadwal TKA"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Kelola jadwal pelaksanaan TKA untuk semua sekolah"})]}),e.jsxs(k,{onClick:()=>h(!0),className:"flex items-center gap-2",children:[e.jsx(P,{className:"w-4 h-4"}),"Tambah Jadwal"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsx("div",{className:"bg-white overflow-hidden shadow-sm sm:rounded-lg",children:e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(b,{className:"h-8 w-8 text-maroon-600"})}),e.jsx("div",{className:"ml-5 w-0 flex-1",children:e.jsxs("dl",{children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Total Jadwal"}),e.jsx("dd",{className:"text-lg font-medium text-gray-900",children:o.length})]})})]})})}),e.jsx("div",{className:"bg-white overflow-hidden shadow-sm sm:rounded-lg",children:e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(N,{className:"h-8 w-8 text-green-600"})}),e.jsx("div",{className:"ml-5 w-0 flex-1",children:e.jsxs("dl",{children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Terjadwal"}),e.jsx("dd",{className:"text-lg font-medium text-gray-900",children:o.filter(a=>a.status==="scheduled").length})]})})]})})}),e.jsx("div",{className:"bg-white overflow-hidden shadow-sm sm:rounded-lg",children:e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(N,{className:"h-8 w-8 text-yellow-600"})}),e.jsx("div",{className:"ml-5 w-0 flex-1",children:e.jsxs("dl",{children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Sedang Berlangsung"}),e.jsx("dd",{className:"text-lg font-medium text-gray-900",children:o.filter(a=>a.status==="ongoing").length})]})})]})})}),e.jsx("div",{className:"bg-white overflow-hidden shadow-sm sm:rounded-lg",children:e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(N,{className:"h-8 w-8 text-gray-600"})}),e.jsx("div",{className:"ml-5 w-0 flex-1",children:e.jsxs("dl",{children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Selesai"}),e.jsx("dd",{className:"text-lg font-medium text-gray-900",children:o.filter(a=>a.status==="completed").length})]})})]})})})]}),e.jsxs("div",{className:"bg-white overflow-hidden shadow-sm sm:rounded-lg mb-6",children:[e.jsx("div",{className:"p-6 border-b border-gray-200",children:e.jsxs("h3",{className:"text-lg font-medium text-gray-900 flex items-center gap-2",children:[e.jsx(ee,{className:"w-5 h-5"}),"Filter & Pencarian"]})}),e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx(r,{htmlFor:"search",value:"Pencarian"}),e.jsxs("div",{className:"relative",children:[e.jsx(E,{className:"absolute left-3 top-3 h-4 w-4 text-gray-400"}),e.jsx(d,{id:"search",type:"text",placeholder:"Cari jadwal...",value:u,onChange:a=>A(a.target.value),className:"pl-10"})]})]}),e.jsxs("div",{children:[e.jsx(r,{htmlFor:"status",value:"Status"}),e.jsxs("select",{id:"status",value:x,onChange:a=>M(a.target.value),className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:border-indigo-500 focus:ring-indigo-500",children:[e.jsx("option",{value:"all",children:"Semua Status"}),e.jsx("option",{value:"scheduled",children:"Terjadwal"}),e.jsx("option",{value:"ongoing",children:"Berlangsung"}),e.jsx("option",{value:"completed",children:"Selesai"}),e.jsx("option",{value:"cancelled",children:"Dibatalkan"})]})]}),e.jsxs("div",{children:[e.jsx(r,{htmlFor:"type",value:"Jenis"}),e.jsxs("select",{id:"type",value:g,onChange:a=>R(a.target.value),className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:border-indigo-500 focus:ring-indigo-500",children:[e.jsx("option",{value:"all",children:"Semua Jenis"}),e.jsx("option",{value:"regular",children:"Reguler"}),e.jsx("option",{value:"makeup",children:"Susulan"}),e.jsx("option",{value:"special",children:"Khusus"})]})]}),e.jsx("div",{className:"flex items-end",children:e.jsxs(w,{onClick:v,className:"w-full",children:[e.jsx(E,{className:"w-4 h-4 mr-2"}),"Refresh"]})})]})})]}),e.jsx("div",{className:"space-y-4",children:T.length===0?e.jsx("div",{className:"bg-white overflow-hidden shadow-sm sm:rounded-lg",children:e.jsxs("div",{className:"p-6 text-center",children:[e.jsx(b,{className:"mx-auto h-12 w-12 text-gray-400"}),e.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"Tidak ada jadwal"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Mulai dengan membuat jadwal TKA pertama"}),e.jsxs(k,{onClick:()=>h(!0),className:"mt-4",children:[e.jsx(P,{className:"w-4 h-4 mr-2"}),"Tambah Jadwal"]})]})}):T.map(a=>{const t=O(a.status),n=$(a.type);return e.jsx("div",{className:"bg-white overflow-hidden shadow-sm sm:rounded-lg hover:shadow-md transition-shadow",children:e.jsxs("div",{className:"p-6 border-b border-gray-200",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:a.title}),e.jsx("p",{className:"mt-1 text-sm text-gray-600",children:a.description})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${t.variant==="default"?"bg-maroon-100 text-maroon-800":t.variant==="secondary"?"bg-green-100 text-green-800":t.variant==="outline"?"bg-gray-100 text-gray-800":"bg-red-100 text-red-800"}`,children:t.text}),e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${n.variant==="default"?"bg-maroon-100 text-maroon-800":n.variant==="secondary"?"bg-yellow-100 text-yellow-800":"bg-purple-100 text-purple-800"}`,children:n.text})]})]}),e.jsxs("div",{className:"mt-4 grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(b,{className:"w-4 h-4 text-gray-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Mulai"}),e.jsx("p",{className:"text-sm text-gray-600",children:K(a.start_date)})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(N,{className:"w-4 h-4 text-gray-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Selesai"}),e.jsx("p",{className:"text-sm text-gray-600",children:K(a.end_date)})]})]})]}),a.instructions&&e.jsxs("div",{className:"mt-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-700 mb-1",children:"Instruksi:"}),e.jsx("p",{className:"text-sm text-gray-600",children:a.instructions})]}),e.jsxs("div",{className:"flex items-center justify-between pt-4 border-t",children:[e.jsxs("div",{className:"text-sm text-gray-500",children:["Dibuat oleh:"," ",a.created_by||"Super Admin"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(w,{onClick:()=>H(a),className:"text-sm",children:[e.jsx(Q,{className:"w-4 h-4 mr-1"}),"Edit"]}),a.status==="scheduled"&&e.jsx(w,{onClick:()=>X(a.id),className:"text-sm",children:"Batalkan"}),e.jsxs(G,{onClick:()=>{window.confirm(`Apakah Anda yakin ingin menghapus jadwal "${a.title}"? Tindakan ini tidak dapat dibatalkan.`)&&I(a.id)},className:"text-sm",children:[e.jsx(Y,{className:"w-4 h-4 mr-1"}),"Hapus"]})]})]})]})},a.id)})})]})}),e.jsx(V,{show:J||B,maxWidth:"7xl",onClose:()=>{h(!1),p(!1),j(null),y()},children:e.jsxs("div",{className:"p-8",children:[e.jsx("h2",{className:"text-xl font-medium text-gray-900 mb-6",children:c?"Edit Jadwal TKA":"Tambah Jadwal TKA"}),e.jsx("p",{className:"text-sm text-gray-600 mb-6",children:c?"Ubah informasi jadwal TKA":"Buat jadwal TKA baru"}),e.jsxs("form",{onSubmit:L,children:[e.jsxs("div",{className:"max-h-[70vh] overflow-y-auto space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(r,{htmlFor:"title",value:"Judul Jadwal *"}),e.jsx(d,{id:"title",type:"text",value:s.title,onChange:a=>l({...s,title:a.target.value}),placeholder:"Contoh: TKA Gelombang 1 - Tahun 2024",required:!0})]}),e.jsxs("div",{children:[e.jsx(r,{htmlFor:"type",value:"Jenis TKA *"}),e.jsxs("select",{id:"type",value:s.type,onChange:a=>l({...s,type:a.target.value}),className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:border-indigo-500 focus:ring-indigo-500",required:!0,children:[e.jsx("option",{value:"regular",children:"Reguler"}),e.jsx("option",{value:"makeup",children:"Susulan"}),e.jsx("option",{value:"special",children:"Khusus"})]})]})]}),e.jsxs("div",{children:[e.jsx(r,{htmlFor:"description",value:"Deskripsi"}),e.jsx("textarea",{id:"description",value:s.description,onChange:a=>l({...s,description:a.target.value}),placeholder:"Deskripsi jadwal TKA...",rows:3,className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:border-indigo-500 focus:ring-indigo-500"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(r,{htmlFor:"start_date",value:"Tanggal & Waktu Mulai *"}),e.jsx(d,{id:"start_date",type:"datetime-local",value:s.start_date,onChange:a=>l({...s,start_date:a.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx(r,{htmlFor:"end_date",value:"Tanggal & Waktu Selesai *"}),e.jsx(d,{id:"end_date",type:"datetime-local",value:s.end_date,onChange:a=>l({...s,end_date:a.target.value}),required:!0})]})]}),e.jsxs("div",{children:[e.jsx(r,{htmlFor:"instructions",value:"Instruksi Khusus"}),e.jsx("textarea",{id:"instructions",value:s.instructions,onChange:a=>l({...s,instructions:a.target.value}),placeholder:"Instruksi khusus untuk peserta...",rows:3,className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:border-indigo-500 focus:ring-indigo-500"})]}),e.jsxs("div",{children:[e.jsx(r,{htmlFor:"target_schools",value:"Sekolah Terpilih (Opsional)"}),e.jsxs("select",{id:"target_schools",value:s.target_schools.length>0?s.target_schools[0]:"",onChange:a=>l({...s,target_schools:a.target.value?[parseInt(a.target.value)]:[]}),className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:border-indigo-500 focus:ring-indigo-500",children:[e.jsx("option",{value:"",children:"Semua Sekolah"}),D.map(a=>e.jsx("option",{value:a.id,children:a.name},a.id))]})]}),e.jsxs("div",{className:"border-t pt-6 mt-6",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-6",children:"📋 Informasi PUSMENDIK (Sesuai Jadwal Resmi)"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(r,{htmlFor:"gelombang",value:"Gelombang *"}),e.jsxs("select",{id:"gelombang",value:s.gelombang,onChange:a=>l({...s,gelombang:a.target.value}),className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:border-indigo-500 focus:ring-indigo-500",required:!0,children:[e.jsx("option",{value:"1",children:"Gelombang 1"}),e.jsx("option",{value:"2",children:"Gelombang 2"})]})]}),e.jsxs("div",{children:[e.jsx(r,{htmlFor:"hari_pelaksanaan",value:"Hari Pelaksanaan *"}),e.jsxs("select",{id:"hari_pelaksanaan",value:s.hari_pelaksanaan,onChange:a=>l({...s,hari_pelaksanaan:a.target.value}),className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:border-indigo-500 focus:ring-indigo-500",required:!0,children:[e.jsx("option",{value:"Hari Pertama",children:"Hari Pertama"}),e.jsx("option",{value:"Hari Kedua",children:"Hari Kedua"})]})]}),e.jsxs("div",{children:[e.jsx(r,{htmlFor:"exam_venue",value:"Tempat Ujian"}),e.jsx(d,{id:"exam_venue",type:"text",value:s.exam_venue,onChange:a=>l({...s,exam_venue:a.target.value}),placeholder:"SMK Negeri 1 Jakarta"})]}),e.jsxs("div",{children:[e.jsx(r,{htmlFor:"exam_room",value:"Ruangan Ujian"}),e.jsx(d,{id:"exam_room",type:"text",value:s.exam_room,onChange:a=>l({...s,exam_room:a.target.value}),placeholder:"Lab Komputer 1"})]}),e.jsxs("div",{children:[e.jsx(r,{htmlFor:"contact_person",value:"Kontak Person"}),e.jsx(d,{id:"contact_person",type:"text",value:s.contact_person,onChange:a=>l({...s,contact_person:a.target.value}),placeholder:"Dr. Sari Indah, M.Pd"})]}),e.jsxs("div",{children:[e.jsx(r,{htmlFor:"contact_phone",value:"Nomor Telepon"}),e.jsx(d,{id:"contact_phone",type:"tel",value:s.contact_phone,onChange:a=>l({...s,contact_phone:a.target.value}),placeholder:"021-3844294"})]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx(r,{htmlFor:"requirements",value:"Persyaratan Peserta"}),e.jsx("textarea",{id:"requirements",value:s.requirements,onChange:a=>l({...s,requirements:a.target.value}),placeholder:"Siswa kelas 12 SMK, membawa KTP/Kartu Pelajar, alat tulis",rows:2,className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:border-indigo-500 focus:ring-indigo-500"})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx(r,{htmlFor:"materials_needed",value:"Bahan yang Diperlukan"}),e.jsx("textarea",{id:"materials_needed",value:s.materials_needed,onChange:a=>l({...s,materials_needed:a.target.value}),placeholder:"Pensil 2B, Penghapus, Rautan, KTP/Kartu Pelajar",rows:2,className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:border-indigo-500 focus:ring-indigo-500"})]})]})]}),e.jsxs("div",{className:"sticky bottom-0 bg-white border-t pt-4 mt-6 flex justify-end space-x-3",children:[e.jsx(w,{type:"button",onClick:()=>{h(!1),p(!1),j(null),y()},children:"Batal"}),e.jsx(k,{type:"submit",disabled:C,children:C?"Menyimpan...":c?"Update":"Simpan"})]})]})]})})]})}export{we as default};
